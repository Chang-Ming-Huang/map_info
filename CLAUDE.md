# Google Maps 評論爬蟲專案

這是一個專門爬取築宜系統傢俱桃園店 Google Maps 評論的 Python 專案，具備智能前置滾動、評論文字提取和圖片自動下載功能。

## 專案結構

```
map_info/
├── google_reviews_scraper.py    # 主要爬蟲程式 (58KB)
├── image_handler.py             # 圖片處理模組 (14KB)
├── requirements.txt             # 依賴套件清單
├── 使用說明.md                  # 完整使用說明
├── CLAUDE.md                    # 本開發記錄
├── images/                      # 圖片下載目錄
│   └── 築宜系統傢俱_桃園店_*/   # 按日期分類的圖片
└── *.json                       # 評論數據輸出檔案
```

## 核心功能

1. **前置滾動優化**: 30次智能滾動，每次檢查並點擊「更多評論」按鈕
2. **循環式爬取**: 滾動→檢查→下載→判斷的穩定循環邏輯
3. **評論提取**: 完整提取評論者、評分、內容、日期等資訊
4. **圖片下載**: 自動下載每則評論的前3張高解析度圖片
5. **智能去重**: 評論和圖片的雙重去重機制

## 使用方法

### 執行爬蟲
```bash
python3 google_reviews_scraper.py
```

### 快速執行
```bash
# Windows PowerShell
python .\google_reviews_scraper.py

# 配置調整 (可選)
# 在程式中修改 UserConfig 和 ScrapingConfig
```

## 技術亮點

### 前置滾動優化 (最新功能)
- **30次前置滾動**: 每次滾動後檢查「更多評論」按鈕
- **交替執行邏輯**: 滾動 → 檢查按鈕 → 點擊 → 繼續滾動
- **智能觸底判斷**: 連續20次無新評論自動停止

### 圖片處理技術
- **CSS背景圖片提取**: 直接從 `background-image` 屬性提取URL
- **高解析度轉換**: 自動將縮圖轉換為原始大小 (`=s0`)
- **URL去重快取**: 避免重複下載相同圖片
- **檔案命名規則**: `review_XXX_img_YY.jpg`

### 爬蟲穩定性
- **多重選擇器**: CSS + XPath 雙重保障
- **評論唯一ID**: 基於 `data-review-id` 或內容組合
- **循環式架構**: 滾動→檢查→下載→判斷的穩定循環
- **錯誤容錯**: 單個評論失敗不影響整體進度

## 執行結果 (2025-09-13)

### 最新爬取統計
- **目標評論數**: 10 則
- **實際獲取**: 10 則 (100% 成功率)
- **平均評分**: 5.0 星 (全部五星好評)
- **圖片下載**: 30 張 (每則評論3張)
- **執行時間**: 約 1分22秒
- **前置滾動**: 30次 + 點擊按鈕

### 輸出檔案
```
築宜系統傢俱_桃園店_評論_20250913_002848.json  # 評論數據
images/築宜系統傢俱_桃園店_20250913/           # 圖片目錄
├── review_001_img_01.jpg ~ review_010_img_03.jpg
```

## 開發歷程

### v1.0 - 基礎爬蟲
- 基本評論提取功能
- Selenium 自動化框架

### v2.0 - 圖片支援
- 新增 `image_handler.py` 模組
- 圖片自動下載和去重

### v3.0 - 前置滾動優化 (當前版本)
- 30次前置滾動機制
- 每次滾動後檢查「更多評論」按鈕
- 交替執行邏輯優化

## 技術棧

- **Python 3.x** - 主要開發語言
- **Selenium 4.15.0** - 網頁自動化
- **Requests 2.31.0** - HTTP 請求處理
- **Pillow 10.1.0** - 圖片處理和驗證
- **Chrome WebDriver** - 瀏覽器驅動

## 專案狀態

✅ **生產就緒** - 程式穩定運行，功能完整，已通過多次測試驗證