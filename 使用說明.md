# Google Maps 評論爬蟲使用說明

## 概述

本項目包含一套完整的 Google Maps 評論爬蟲工具，專門用於爬取和分析 Google Maps 上的商家評論。

## 檔案結構

```
map_info/
├── requirements.txt                     # Python 依賴套件
├── google_reviews_scraper.py           # 主要爬蟲程式
├── test_scraper.py                     # 測試程式
├── analyze_reviews.py                  # 評論分析工具
├── 使用說明.md                         # 本說明檔案
└── 輸出檔案/
    ├── 築宜系統傢俱_桃園店_評論_*.json
    ├── 築宜系統傢俱_桃園店_評論_*.xlsx
    └── debug_screenshot_*.png
```

## 功能特色

### 1. 主要爬蟲程式 (google_reviews_scraper.py)
- **自動化瀏覽器操作**: 使用 Selenium 模擬真實用戶行為
- **智能滾動載入**: 自動滾動載入更多評論
- **評論展開**: 自動點擊"更多"按鈕展開完整評論文字
- **多格式輸出**: 支援 JSON 和 Excel 格式
- **反爬蟲機制**: 隨機延遲、User-Agent 輪替

### 2. 測試程式 (test_scraper.py)
- **頁面結構檢測**: 分析目標網頁結構
- **元素定位測試**: 測試不同的選擇器
- **調試截圖**: 自動保存頁面截圖供調試

### 3. 分析工具 (analyze_reviews.py)
- **去重處理**: 智能識別和移除重複評論
- **統計分析**: 評分分布、評論長度等統計
- **情感分析**: 正面/負面關鍵詞統計
- **設計師提及**: 提取評論中提及的設計師名稱

## 使用步驟

### 1. 環境準備
```bash
# 安裝依賴套件 (如果需要)
pip install -r requirements.txt

# 確認 Chrome 瀏覽器已安裝
google-chrome --version
```

### 2. 測試爬蟲
```bash
# 執行測試程式，確認目標網站可正常存取
python3 test_scraper.py
```

### 3. 執行爬蟲
```bash
# 執行主要爬蟲程式
python3 google_reviews_scraper.py
```

### 4. 分析數據
```bash
# 分析爬取的評論數據
python3 analyze_reviews.py
```

## 爬蟲結果

### 築宜系統傢俱-桃園店 爬蟲結果
- **總評論數**: 8 個 (去重後)
- **平均評分**: 5.00 星
- **主要設計師**: Nick (7次提及), Roy (2次提及)
- **情感傾向**: 正面 (正面關鍵詞 18 次，負面關鍵詞 2 次)

## 輸出檔案說明

### JSON 格式
```json
[
  {
    "reviewer_name": "評論者姓名",
    "rating": 5,
    "review_text": "評論內容",
    "review_date": "發布日期",
    "scraped_at": "爬取時間",
    "review_id": 1
  }
]
```

### Excel 格式
包含相同的數據欄位，便於進一步分析和處理。

## 技術細節

### 反爬蟲策略
1. **隨機 User-Agent**: 輪替不同的瀏覽器標識
2. **隨機延遲**: 2-5秒的隨機等待時間
3. **錯誤重試**: 自動重試失敗的操作
4. **頭部模式**: 可選擇無頭模式運行

### 數據提取策略
- **多重選擇器**: 使用多種 CSS/XPath 選擇器確保兼容性
- **容錯處理**: 對每個數據欄位都有容錯機制
- **滾動載入**: 智能滾動載入更多評論內容

## 注意事項

### 法律和倫理考量
1. **遵守服務條款**: 確保使用符合 Google 服務條款
2. **合理使用**: 避免過度頻繁的請求
3. **數據保護**: 妥善處理用戶評論數據
4. **商業用途**: 了解商業使用的限制

### 技術限制
1. **頁面結構變更**: Google Maps 頁面結構可能隨時改變
2. **反爬蟲機制**: Google 的反爬蟲機制可能導致封鎖
3. **網路環境**: 需要穩定的網路連線
4. **瀏覽器依賴**: 需要安裝 Chrome 瀏覽器

## 故障排除

### 常見問題
1. **找不到評論按鈕**: 檢查頁面 URL 是否正確
2. **無法載入更多評論**: 調整滾動次數和等待時間
3. **Chrome 驅動程式問題**: webdriver-manager 會自動下載最新驅動

### 調試建議
1. 將 `headless=False` 觀察瀏覽器行為
2. 檢查 debug_screenshot 截圖
3. 查看控制台輸出的錯誤信息

## 擴展功能

### 自定義目標
修改 `main()` 函數中的 URL 來爬取其他商家：
```python
url = "你的目標商家 Google Maps URL"
```

### 調整參數
- `max_scrolls`: 調整滾動次數
- `headless`: 設為 True 在背景運行
- 延遲時間: 根據網路狀況調整

## 更新維護

由於 Google Maps 的頁面結構可能會變更，建議：
1. 定期更新選擇器
2. 監控爬蟲成功率
3. 根據需要調整反爬蟲策略

## 聯繫支援

如有技術問題或改進建議，請檢查：
1. 錯誤日誌和截圖
2. 網路連線狀況
3. Chrome 瀏覽器版本

---

**警告**: 本工具僅供學習和研究使用。使用前請確保遵守相關法律法規和服務條款。